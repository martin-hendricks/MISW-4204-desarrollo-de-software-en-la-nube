# ===== WORKER INSTANCE ENVIRONMENT VARIABLES =====
# Copiar este archivo como .env y completar con los valores reales

# ===== DATABASE (RDS PostgreSQL) =====
# DEBE SER EL MISMO que en Backend
# Formato: postgresql://usuario:password@endpoint:puerto/nombre_db
DATABASE_URL=postgresql://USER:PASSWORD@RDS_ENDPOINT:5432/DATABASE_NAME

# ===== MESSAGE BROKER (Redis o AWS SQS) =====
# Para usar AWS SQS, cambiar USE_SQS=true y configurar las colas
USE_SQS=false

# Redis (broker por defecto - solo si USE_SQS=false)
# Usar la IP PRIVADA de la instancia Backend
# Formato: redis://IP_PRIVADA_BACKEND:6379/0
REDIS_URL=redis://BACKEND_PRIVATE_IP:6379/0

# AWS SQS (broker alternativo para autoscaling - solo si USE_SQS=true)
# Obtener estos valores ejecutando: deployment/sqs-setup/setup-sqs.sh
# DEBEN SER LAS MISMAS URLs que en el Backend
SQS_QUEUE_URL=
SQS_DLQ_URL=
AWS_REGION=us-east-1

# ===== FILE STORAGE =====
# Directorio donde se almacenan los videos (montado desde NFS)
# ===== STORAGE CONFIGURATION =====
# Opciones: 'local' (NFS) o 's3' (AWS S3)
STORAGE_TYPE=local

# ===== OPCIÓN 1: Almacenamiento Local/NFS =====
# Usar cuando STORAGE_TYPE=local
# Requiere ejecutar: ./setup-nfs-mount.sh antes de docker-compose up
UPLOAD_DIR=/app/uploads

# ===== OPCIÓN 2: Almacenamiento S3 =====
# Usar cuando STORAGE_TYPE=s3
# DEBEN ser las MISMAS credenciales que el Backend
# Requiere ejecutar: ./setup-s3.sh antes de docker-compose up
# IMPORTANTE: Comentar el volumen NFS en docker-compose.yml

# Para cuentas AWS regulares:
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=us-east-1
S3_BUCKET_NAME=

# Para AWS Academy (credenciales temporales):
# Copiar desde AWS Academy > AWS Details > AWS CLI
# IMPORTANTE: Las credenciales AWS Academy expiran cada 4 horas
AWS_SESSION_TOKEN=

# ===== BASE PATH =====
# URL pública del Backend para generar URLs de videos
# Debe apuntar a la IP pública o dominio del Backend
BASE_PATH=http://BACKEND_PUBLIC_IP/api/videos

# ===== CELERY CONFIGURATION =====
CELERY_CONCURRENCY=4
CELERY_MAX_RETRIES=3
CELERY_RETRY_DELAY=60

# ===== LOGGING =====
LOG_LEVEL=INFO

# ===== PYTHON =====
PYTHONPATH=/app

# ===== CLOUDWATCH METRICS =====
# Namespace para métricas de CloudWatch
CLOUDWATCH_NAMESPACE=ANB/Worker
# Environment tag (development, staging, production)
ENVIRONMENT=production

# ===== WORKER HEALTH API =====
WORKER_API_HOST=0.0.0.0
WORKER_API_PORT=8001

# ===== VIDEO PROCESSING ASSETS =====
# Estas rutas son internas al contenedor
# Los archivos se deben colocar en la carpeta ./assets/ del host
LOGO_PATH=/app/assets/anb_logo.png
INTRO_VIDEO_PATH=/app/assets/intro.mp4
OUTRO_VIDEO_PATH=/app/assets/outro.mp4
LOGO_POSITION=top-right

# ===== INSTRUCCIONES DE USO =====
# Para usar NFS:
#   1. STORAGE_TYPE=local
#   2. Ejecutar: ./setup-nfs-mount.sh
#   3. Mantener volumen activo en docker-compose.yml
#   4. docker-compose up -d
#
# Para usar S3:
#   1. STORAGE_TYPE=s3
#   2. Configurar AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY, S3_BUCKET_NAME
#      (DEBEN ser las mismas credenciales que el Backend)
#   3. Ejecutar: ./setup-s3.sh
#   4. Comentar volumen NFS en docker-compose.yml (línea 33)
#   5. docker-compose up -d
